<!DOCTYPE html>

<head>
    <title>Notes Tracker</title>

    <!-- Dynamic stylesheet - so no href to begin with -->
    <link id="theme_css" rel="stylesheet">

    <link rel="shortcut icon" href="/static/img/icon-note.svg">
</head>

<body>
    <nav class="navbar has-background-primary" role="navigation">
        <div class="navbar-brand">
            <div class="navbar-item">
                <img src="/static/img/icon-notebook.svg">
                Note Tracker
            </div>
        </div>

        <div class="navbar-end">
            <div class="navbar-item">
                <div class="control has-icons-left">
                    <div class="select">
                        <select id="theme_select">
                        </select>
                    </div>

                    <div class="icon is-left">
                        <img src="/static/img/icon-color-swatch.svg">
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <section class="section">
        <div class="container">
            <div id="app"></div>
        </div>
    </section>

    <script type="application/javascript">
        function select_from_array(select, array, text_field, value_field, default_text) {
            let default_value = '';

            for (const val of array) {
                const option = document.createElement('option')
                option.text = val[text_field]
                option.value = val[value_field]
                if (val[text_field] === default_text) {
                    option.defaultSelected = true
                    default_value = option.value
                }

                select.add(option)
            }

            return default_value
        }

        const theme_link = document.getElementById('theme_css')
        const theme_select = document.getElementById('theme_select')
        const default_theme_name = 'Default'

        fetch('https://jenil.github.io/bulmaswatch/api/themes.json')
            .then(resp => resp.json())
            .then(resp => select_from_array(theme_select, resp.themes, 'name', 'css', default_theme_name))
            .then(resp => theme_link.href = resp)
            .catch(err => console.log(err))

        theme_select.addEventListener('change', (event) => {
            theme_link.href = event.target.value
        })

        theme_link.href = theme_select.value
    </script>

    <script type="module" src="static/js/app.js"></script>
</body>